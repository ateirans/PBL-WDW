<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FEASTFOUND - Toko Vendor</title> 
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0; padding: 0; background-image: radial-gradient(circle at center, #ec9393, #d56f6f, #cb9f7c); 
            color: #4b3832; overflow-x: hidden; 
        }
        .sticky-top { position: sticky; top: 0; z-index: 1000; }
        .hidden { display: none; }

        /* HEADER     */
        .header-container {
            background-color: rgba(40, 23, 3, 0.9); 
            padding: 10px 30px; 
            border-radius: 40px; 
            margin: 20px; 
             box-shadow: 0 4px 8px rgb(147, 5, 5);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .nav-bar {
            display: flex; justify-content: space-between; align-items: center;
            flex-wrap: wrap; max-width: 1400px; margin: 0 auto; padding: 0; 
        }

        .nav-links {
            display: flex; align-items: center; gap: 8px; 
            flex: 1; justify-content: flex-start; 
        }

        .nav-logo {
            display: flex; justify-content: center; flex: 0 0 auto; margin: 0 20px;
        }
        .logo-img {
            height: 50px; width: auto; object-fit: contain; 
            border-radius: 50%; border: 2px solid #7f0a6d; 
        }

        .search-and-cart { 
            display: flex; align-items: center; gap: 15px; 
            flex: 1; justify-content: flex-end; 
        }

        /* TOMBOL NAVIGASI */
        .nav-links .btn {
            background-color: #f0a359 !important; 
            color: white !important;
            padding: 8px 18px; 
            font-family: 'Arial', sans-serif;
            font-size: 0.85rem; 
            font-weight: bold;
            border-radius: 30px; 
            border: 2px solid transparent !important; 
            transition: all 0.3s ease;
        }
        .nav-links .btn:hover {
            background-color: #ffffff !important; 
            color: #f0a359 !important;            
            border: 2px solid #f0a359 !important; 
            transform: translateY(-2px);          
        }
        .nav-links .btn-logout {
            background-color: #dc3545 !important; 
            border-color: #dc3545 !important;
        }
        .nav-links .btn-logout:hover {
            background-color: #b02a37 !important; 
            color: white !important;              
        }

        /* SEARCH BAR  */
        .search-container { 
            display: flex; align-items: center; max-width: 250px; width: 100%;
        }
        .search-container #searchInput {
            padding: 8px 15px; height: 40px; font-size: 0.9em; 
            border: 1px solid #7c5747; 
            border-radius: 0 4px 4px 0; 
            outline: none; width: 100%;
            background-color: white;
            cursor: pointer; 
        }
        .search-container .btn-primary { 
            background-color: #f0a359; color: white; border: 1px solid #f0a359; 
            padding: 0 15px; height: 40px; border-radius: 0 4px 4px 0; 
            cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .search-container .btn-primary:hover { background-color: #e55c0a; }

        /* CART ICON */
        #cart-icon-container .cart-circle { 
            width: 40px; height: 40px; background-color: #f0a359; color: white; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            font-size: 1.1rem; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: all 0.3s ease; 
        }
        #cart-icon-container:hover .cart-circle { background-color: #e55c0a; transform: scale(1.1); }
        #cart-count { font-size: 0.7rem; }

     
        /* 3. KONTEN TOKO  */
        .vendor-hero-section {
            position: relative; margin-bottom: 50px; border-radius: 20px; 
            overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.2); height: 350px;
        }
        .vendor-banner-img {
            width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease;
        }
        .vendor-hero-section:hover .vendor-banner-img { transform: scale(1.05); }
        .vendor-overlay {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.3) 50%, transparent 100%);
            display: flex; flex-direction: column; justify-content: flex-end; padding: 40px; color: white;
        }
        .vendor-title-large { font-size: 3.5rem; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); margin-bottom: 5px; }
        .vendor-badge { background-color: #f0a359; color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.9rem; font-weight: bold; display: inline-block; margin-bottom: 10px; }

        .section-heading { font-size: 2rem; font-weight: 700; color: #4b3832; margin-bottom: 30px; border-left: 5px solid #f0a359; padding-left: 15px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 30px; padding-bottom: 40px; }
        
        /* PRODUCT CARD  */
        .product-card {
            background: #ad1f06; border-radius: 20px; border: none; overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: all 0.3s ease;
            display: flex; flex-direction: column; height: 100%;
        }
        .product-card:hover { transform: translateY(-10px); box-shadow: 0 15px 35px rgba(124, 87, 71, 0.15); }
        
        .product-img-wrapper { height: 200px; overflow: hidden; position: relative; }
        .product-card img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease; }
        .product-card:hover img { transform: scale(1.05); }
        
        .product-info { padding: 20px; flex-grow: 1; display: flex; flex-direction: column; text-align: left; }
        .product-info h3 { font-size: 1.25rem; font-weight: 700; margin-bottom: 8px; color: #4b3832; line-height: 1.3; }
        .product-desc { font-size: 0.9rem; color: #777; margin-bottom: 15px; flex-grow: 1; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .price { font-size: 1.35rem; color: #e55c0a; font-weight: 800; margin-bottom: 20px; }
        .product-action-buttons {
            margin-top: auto; 
            display: flex; gap: 10px;
        }

        .btn-buy-now {
            flex-grow: 1;
            background: linear-gradient(to right, #f0a359, #e55c0a); 
            color: white; border: none;
            padding: 12px;
            border-radius: 15px;
            font-weight: 700; font-size: 1rem;
            transition: 0.3s; cursor: pointer;
        }
        .btn-buy-now:hover {
            filter: brightness(1.1);
            box-shadow: 0 5px 15px rgba(229, 92, 10, 0.3);
            transform: translateY(-2px);
        }
        
        .btn-add-cart-icon {
            width: 48px; height: 48px; 
            display: flex; align-items: center; justify-content: center;
            background: #fff6e8; 
            color: #e55c0a; 
            border: 2px solid #ffe0b2; 
            border-radius: 15px;
            font-size: 1.2rem; transition: 0.3s; cursor: pointer;
        }
        .btn-add-cart-icon:hover {
            background: #f0a359; color: white; border-color: #f0a359;
            transform: translateY(-2px);
        }

        /* ulasan */
        #vendor-comments-area { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); margin-top: 40px; }
        .comment-item { background: #f9f9f9; border-radius: 12px; padding: 20px; margin-bottom: 15px; border-left: 4px solid #f0a359; }
        .comment-user { font-weight: 700; color: #333; display: block; margin-bottom: 5px; }
        .comment-date { font-size: 0.8rem; color: #999; float: right; }
        .comment-text { color: #555; font-style: italic; }
        
        #comment-form textarea { background: #fff; border: 2px solid #eee; border-radius: 10px; padding: 15px; transition: 0.3s; width: 100%; }
        #comment-form textarea:focus { border-color: #f0a359; outline: none; box-shadow: 0 0 10px rgba(240, 163, 89, 0.2); }
        #submit-comment-button { background: #4b3832; color: white; padding: 12px 30px; border-radius: 30px; font-weight: bold; border: none; margin-top: 10px; transition: 0.3s; }
        #submit-comment-button:hover { background: #9b0707; transform: translateY(-2px); }

        @media (max-width: 992px) {
            .header-container { padding: 10px 20px; margin: 10px; border-radius: 12px; }
            .nav-bar { flex-direction: column; align-items: center; gap: 15px; }
            .nav-logo { order: 1; margin-bottom: 5px; }
            .search-and-cart { order: 2; width: 100%; justify-content: center; gap: 10px; }
            .nav-links { order: 3; width: 100%; justify-content: center; flex-wrap: wrap; border-top: 1px dashed rgba(255,255,255,0.2); padding-top: 10px; }
            .search-container { max-width: 100%; flex-grow: 1; }
            .nav-links .btn { padding: 6px 12px; font-size: 0.8em; }
            .vendor-hero-section { height: 250px; }
            .vendor-title-large { font-size: 2.5rem; }
        }
    </style>
</head>
<body id="vendor-shop-page">

    <header class="header-container sticky-top" style="min-height: 80px; padding: 15px 25px; display: flex; align-items: center;">
        <nav class="navbar navbar-expand-lg p-0 w-100">
            <div class="container-fluid p-0">
                
                <button class="navbar-toggler bg-light" type="button" data-bs-toggle="collapse" data-bs-target="#vendorNavbar">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse justify-content-between align-items-center" id="vendorNavbar">
                    
                    <div class="d-flex flex-wrap justify-content-center justify-content-lg-start gap-1 nav-links mt-3 mt-lg-0">
                        <a href="login.html" id="authButton" onclick="handleAuth(event)" class="btn">LOGIN</a>
                        <a href="index.html" class="btn">HOME</a>
                        <a href="index.html#product-list" class="btn">MENU</a>
                        <a href="index.html#about-section" class="btn">ABOUT</a>
                        <a href="index.html#contact-section" class="btn">CONTACT</a>
                    </div>

                    <div class="nav-logo mx-3 text-center my-2 my-lg-0">
                        <a href="index.html"><img src="logopbl.png" alt="Logo" class="logo-img" style="height: 50px; width: auto;"></a>
                    </div>

                    <div class="d-flex justify-content-center justify-content-lg-end align-items-center search-and-cart mt-3 mt-lg-0">
                        
                        <div class="input-group search-container me-3" style="max-width: 250px; flex-wrap: nowrap;"> 
                            <input type="text" id="searchInput" placeholder="Cari..." class="form-control form-control-sm" readonly style="cursor:pointer; width: auto !important; flex-grow: 1;"> 
                            <button class="btn btn-primary btn-sm" id="searchButton" style="border-top-left-radius: 0; border-bottom-left-radius: 0;"><i class="fas fa-search"></i></button>
                        </div>

                        <a href="cart.html" id="cart-icon-container" class="text-decoration-none position-relative">
                            <div class="cart-circle"><i class="fas fa-shopping-cart"></i></div>
                            <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none">0</span>
                        </a>
                    </div>

                </div>
            </div>
        </nav>
    </header>

    <main class="container py-4">
        <section id="vendor-shop-section">
            <div class="vendor-hero-section">
                <img id="vendorBannerImage" src="" alt="Banner Toko" class="vendor-banner-img">
                <div class="vendor-overlay">
                    <span class="vendor-badge"><i class="fas fa-check-circle"></i> Official Vendor</span>
                    <h1 class="vendor-title-large" id="vendor-shop-title">Memuat Toko...</h1>
                    <p class="mb-0 opacity-75"><i class="fas fa-map-marker-alt"></i> Jakarta, Indonesia â€¢ <i class="fas fa-star text-warning"></i> 4.8 Rating</p>
                </div>
            </div>
            
            <h2 class="section-heading">Daftar Menu Spesial</h2>
            <div id="vendor-products-container" class="product-grid"></div>
            
            <div id="vendor-comments-area">
                <h2 class="section-heading" style="font-size: 1.5rem; margin-bottom: 20px;">Ulasan Pelanggan</h2>
                <div id="comments-list"></div>
                <form id="comment-form" class="d-flex flex-column mt-4 d-none" data-vendor-id="">
                    <p class="text-muted small mb-2 fw-bold" id="review-as-user" style="display:none; color: #f0a359 !important;"></p>
                    <textarea id="comment-text" placeholder="Bagaimana pengalamanmu? Tulis ulasan di sini..." rows="3" required></textarea>
                    <button type="submit" id="submit-comment-button"><i class="fas fa-paper-plane me-2"></i> Kirim Ulasan</button>
                </form>
                <div id="login-to-review-message" class="text-center mt-4 p-3 bg-light rounded d-none">
                    <p class="mb-0 text-muted">Ingin memberikan ulasan?</p>
                    <a href="login.html" class="btn btn-sm btn-outline-dark mt-2 fw-bold">Login Sekarang</a>
                </div>
            </div>
        </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const vendors = [ {id:1,name:'Dapur Cepat Saji'}, {id:2,name:'Kopi Nusantara'}, {id:3,name:'Taco Loco'} ];
        function loadProducts(){
            const defaultData = [
                {id:101,name:'Classic Beef Burger',price:35000,vendorId:1,img:'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?q=80&w=1000',desc:'Daging sapi premium dengan keju leleh.'},
                {id:102,name:'Cheesy Hotdog',price:28000,vendorId:1,img:'https://images.unsplash.com/photo-1629835748281-54c30c8227b4?q=80&w=1000',desc:'Sosis bakar dengan topping keju melimpah.'},
                {id:103,name:'Strawberry Waffle',price:45000,vendorId:1,img:'https://images.unsplash.com/photo-1549488347-152e00e84b1d?q=80&w=1000',desc:'Waffle renyah dengan es krim.'},
                {id:201,name:'Boba Brown Sugar',price:25000,vendorId:2,img:'https://images.unsplash.com/photo-1590457199104-e21b77ce4685?q=80&w=1000',desc:'Minuman boba kekinian.'},
                {id:202,name:'Es Kopi Susu',price:22000,vendorId:2,img:'https://images.unsplash.com/photo-1521303102379-ed54238e55e0?q=80&w=1000',desc:'Kopi susu gula aren.'},
                {id:301,name:'Chicken Taco',price:38000,vendorId:3,img:'https://images.unsplash.com/photo-1552332386-f8dd0060d402?q=80&w=1000',desc:'Taco ayam khas Meksiko.'},
                {id:302,name:'Nachos Keju',price:30000,vendorId:3,img:'https://images.unsplash.com/photo-1613589874413-5a04c10a42ab?q=80&w=1000',desc:'Camilan nachos renyah.'}
            ];
            const stored = localStorage.getItem('feastfoundProducts');
            return stored ? JSON.parse(stored) : (localStorage.setItem('feastfoundProducts', JSON.stringify(defaultData)), defaultData);
        }
        
        let products = loadProducts();
        let cart = JSON.parse(localStorage.getItem('feastfoundCart')) || [];
        let comments = JSON.parse(localStorage.getItem('feastfoundComments')) || [
            { id: 1, vendorId: 1, user: 'budi@mail.com', text: 'Burgernya juicy banget, recommended!', date: '01/05/2024' },
            { id: 2, vendorId: 2, user: 'ani@mail.com', text: 'Kopinya pas, gak terlalu manis.', date: '05/05/2024' },
        ];
        
        function setVendorImageHTML(vendorId, vendorName){
            const imgElement = document.getElementById('vendorBannerImage');
            let vendorImage = '';
            if (vendorId === 1) vendorImage = 'https://images.unsplash.com/photo-1550547660-d9450f859349?q=80&w=2000'; 
            else if (vendorId === 2) vendorImage = 'https://images.unsplash.com/photo-1497935586351-b67a49e012bf?q=80&w=2000';
            else if (vendorId === 3) vendorImage = 'https://images.unsplash.com/photo-1565299585323-38d6b0865b47?q=80&w=2000'; 
            else vendorImage = 'logopbl.png';
            imgElement.src = vendorImage;
        }

        const formatRupiah = (n) => new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(n);
        
        function updateCartCount(){
            const total = cart.reduce((a, b) => a + b.quantity, 0); 
            const badge = document.getElementById('cart-count'); 
            if(badge){ badge.textContent = total; badge.classList.toggle('d-none', total === 0); }
        }

        function updateAuthButton(){ 
            const button = document.getElementById('authButton'); 
            const role = localStorage.getItem('role');
            const userEmail = localStorage.getItem('userEmail');
            const reviewAsUser = document.getElementById('review-as-user');

            if(role === 'User'){
                button.textContent = 'LOGOUT';
                button.href = "#"; 
                button.onclick = logout; 
                button.classList.add('btn-logout');
                reviewAsUser.innerHTML = `<i class="fas fa-user"></i> Mengulas sebagai: ${userEmail}`;
                reviewAsUser.style.display = 'block';
            } else{
                button.textContent = 'LOGIN';
                button.href = 'login.html'; 
                button.onclick = null;
                button.classList.remove('btn-logout');
                reviewAsUser.style.display = 'none';
            }
            if (document.getElementById('vendor-shop-page')) initVendorShop();
        }
        
        function logout(){ 
            if(confirm('Yakin ingin keluar?')){
                localStorage.removeItem('role');
                localStorage.removeItem('userEmail');
                cart = []; 
                updateCartCount();
                updateAuthButton();
                window.location.href = 'index.html';
            }
        }
        function handleAuth(e){
            const userRole = localStorage.getItem('role');
            if(userRole === 'User'){
                e.preventDefault(); 
                logout();
            }
        }
        
        function addToCart(id){
            if(localStorage.getItem('role')!=='User'){ alert('Harap Login sebagai User.'); window.location.href = 'login.html'; return; }
            const p = products.find(x => x.id === id);
            const item = cart.find(x => x.id === id);
            item ? item.quantity++ : cart.push({...p, quantity: 1, selected: true});
            localStorage.setItem('feastfoundCart', JSON.stringify(cart));
            updateCartCount();
            alert(p.name + ' masuk keranjang!');
        }

        function buyNow(id) {
            if (localStorage.getItem('role') !== 'User') { alert('Harap Login sebagai User.'); window.location.href = 'login.html'; return; }
            const p = products.find(x => x.id === id);
            let item = cart.find(x => x.id === id);
            if (!item) { item = { ...p, quantity: 1, selected: true }; cart.push(item); } 
            else { item.selected = true; }
            localStorage.setItem('feastfoundCart', JSON.stringify(cart));
            localStorage.setItem('checkoutItems', JSON.stringify([item]));
            window.location.href = 'checkout.html';
        }

        function renderComments(vendorId){
            const list = document.getElementById('comments-list');
            const vComments = comments.filter(c => c.vendorId === vendorId).sort((a, b) => new Date(b.date) - new Date(a.date)); 
            if(list){
                if(vComments.length === 0){ list.innerHTML = '<p class="text-center text-muted py-3">Belum ada ulasan. Jadilah yang pertama!</p>'; return; }
                list.innerHTML = vComments.map(c => `
                    <div class="comment-item">
                        <span class="comment-date"><i class="far fa-clock"></i> ${c.date}</span>
                        <span class="comment-user"><i class="fas fa-user-circle text-warning"></i> ${c.user.split('@')[0]}</span>
                        <p class="comment-text mb-0">"${c.text}"</p>
                    </div>
                `).join('');
            }
        }

        function submitComment(e){
            e.preventDefault();
            if(localStorage.getItem('role') !== 'User'){ window.location.href = 'login.html'; return; }
            const form = e.target;
            const vendorId = parseInt(form.getAttribute('data-vendor-id'));
            const text = document.getElementById('comment-text').value.trim();
            if(!text) return;

            comments.push({
                id: comments.length + 1, vendorId: vendorId, user: localStorage.getItem('userEmail'),
                text: text, date: new Date().toLocaleDateString('id-ID')
            });
            localStorage.setItem('feastfoundComments', JSON.stringify(comments));
            document.getElementById('comment-text').value = ''; 
            renderComments(vendorId); 
        }
        
        function renderProducts(productList, container){
            if (!container) return;
            container.innerHTML = productList.map(p => `
                <div class="product-card">
                    <div class="product-img-wrapper">
                        <img src="${p.img}" alt="${p.name}">
                    </div>
                    <div class="product-info">
                        <h3>${p.name}</h3>
                        <p class="product-desc">${p.desc}</p>
                        <p class="price">${formatRupiah(p.price)}</p>
                        <div class="product-action-buttons">
                            <button class="btn-buy-now" onclick="buyNow(${p.id})">Beli Sekarang</button>
                            <button class="btn-add-cart-icon" onclick="addToCart(${p.id})" title="Tambah ke Keranjang"><i class="fas fa-cart-plus"></i></button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function initVendorShop(){
            const params = new URLSearchParams(window.location.search);
            const vId = parseInt(params.get('vendorId'));
            if (!vId) { document.getElementById('vendor-shop-title').textContent = 'Vendor Tidak Ditemukan'; return; }
            const v = vendors.find(val => val.id === vId);
            if (!v) return;

            document.title = v.name + ' - FeastFound';
            document.getElementById('vendor-shop-title').innerHTML = v.name;
            setVendorImageHTML(vId, v.name);

            renderProducts(products.filter(p => p.vendorId === vId), document.getElementById('vendor-products-container'));
            renderComments(vId);
            
            const form = document.getElementById('comment-form');
            const msg = document.getElementById('login-to-review-message');
            form.setAttribute('data-vendor-id', vId); 
            
            const isUser = localStorage.getItem('role') === 'User';
            form.classList.toggle('d-none', !isUser); 
            msg.classList.toggle('d-none', isUser);

            form.removeEventListener('submit', submitComment);
            form.addEventListener('submit', submitComment);
        }

        document.addEventListener('DOMContentLoaded', () => {
            initVendorShop();
            updateCartCount();
            updateAuthButton(); 
            
            const searchInput = document.getElementById('searchInput');
            const searchButton = document.getElementById('searchButton');
            function redirectSearch() { window.location.href = 'search_results.html'; }
            if (searchInput) { searchInput.addEventListener('click', redirectSearch); searchInput.addEventListener('focus', redirectSearch); }
            if (searchButton) { searchButton.addEventListener('click', redirectSearch); }
        });
    </script>
</body>
</html>